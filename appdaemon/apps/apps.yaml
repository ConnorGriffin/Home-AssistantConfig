---
#testing:
#  module: lights
#  class: Testing
#  entities:
#    - light.connors_office_light

lock:
  module: lock
  class: Lock
  trackers:
    - tracker_name: Connor
      tracker: device_tracker.connor_galaxys8
      notify_name: simplepush_connor
    - tracker_name: Diana
      tracker: device_tracker.diana_pixel2
      #notify_name: simplepush_diana
  # Time in seconds before arming the auto-unlock
  not_home_duration: 300
  lock_entity: lock.front_door_lock
  constrain_input_boolean: input_boolean.smart_unlock_automation


lights:
  module: lights
  class: Lights
  # These defaults can be overridden at the entity level
  # Brightness defaults (used in double-taps and schedules)
  max_brightness: 100
  min_brightness: 10

  # How long after detecting presence before turning on/off
  on_delay: 0
  off_delay: 15

  # How long a light needs to be on/off before another on/off state will be listened for, deals with buggy GE dimmer reporting
  on_threshold: 3
  off_threshold: 3

  brightness_schedule:
    - pct: 75
      start: '9:00:00'
      end: '10:00:00'
    - pct: max_brightness
      start: '12:00:00'
      end: '16:00:00'
    - pct: 70
      start: '18:00:00'
      end: '18:00:00'
    - pct: 15
      start: '21:00:00'
      end: '22:30:00'
    - pct: min_brightness
      start: '00:00:00'
      end: '06:00:00'

  entities:
    - name: connors_office_light

    - name: dianas_office_light
      min_brightness: 8

    - name: bathroom_light
      min_brightness: 15
      motion_sensor: binary_sensor.bathroom_motion
      humidity_sensor: sensor.bathroom_relative_humidity
      humidity_threshold: 65
      off_delay: 470 # +30 built into sensor
      on_delay: 0

    - name: hallway_light
      min_brightness: 14
      brightness_schedule:
      - pct: 55
        start: '9:00:00'
        end: '10:00:00'
      - pct: max_brightness
        start: '12:00:00'
        end: '16:00:00'
      - pct: 40
        start: '18:00:00'
        end: '18:00:00'
      - pct: min_brightness
        start: '21:00:00'
        end: '06:00:00'

    - name: dining_room_light
      min_brightness: 13
      brightness_schedule:
      - pct: 55
        start: '9:00:00'
        end: '10:00:00'
      - pct: max_brightness
        start: '12:00:00'
        end: '16:00:00'
      - pct: 40
        start: '18:00:00'
        end: '18:00:00'
      - pct: min_brightness
        start: '21:00:00'
        end: '06:00:00'

    - name: bedroom_light
      min_brightness: 8.5
      snooze_minutes: 10
      alarms:
        #- hide_switch_from_groups:
        #    - bedroom
        - alarm_groups:
            - alarm1
            - alarm2
            - alarm3
            - alarm4
            - alarm5
            - "Connor's phone"

alarm_clock:
  module: alarm_clock
  class: AlarmClock
  constrain_input_boolean: input_boolean.alarm_clock_automation

low_battery_alert:
  module: battery
  class: LowBattery
  constrain_input_boolean: input_boolean.low_battery_alert
  level: 15
  entities:
    - zwave.front_door_lock
    - zwave.front_door_sensor
    - zwave.front_window_right_sensor
    - zwave.bathroom_multisensor_6
    - zwave.back_door_sensor

ecobee:
  module: ecobee
  class: Ecobee
  # Not used as an app constraint (constrain_input_boolean), used as a config variable
  constrain_boolean: input_boolean.ecobee_auto_home_away
  ecobee_entity: climate.home
  presence_entity: group.all_devices
  # How long to wait before setting a hold/resume based on presence
  home_delay: 0
  not_home_delay: 120
  climate_modes:
    # When away during these, set a home hold
    usually_home:
      - Home
      - Peak
      - Sleep
    # When home during these, set an away hold
    usually_not_home:
      - Away
    # For documentation purposes only, take no action
    no_action:
      - Pre Peak

presence:
  module: presence
  class: Presence
  constrain_input_boolean: input_boolean.room_presence
  rooms:
    - name: Bedroom
      entity: binary_sensor.bedroom_occupancy
    - name: Connor's Office
      entity: binary_sensor.connor_office_occupancy
    - name: Diana's Office
      entity: binary_sensor.diana_office_occupancy

install_dependencies:
  module: install_deps
  class: InstallDeps
  priority: 0
  packages:
    - lxml
    - responses

door_autolock:
  module: door_autolock
  class: DoorAutolock
  constrain_input_boolean: input_boolean.smart_autolock_automation
  closed_seconds: 60
  unlocked_seconds: 60
  doors:
    - door: Front Door
      lock: lock.front_door_lock
      sensor: sensor.front_door_state
    - door: Back Door
      sensor: sensor.back_door_state


#door_window_climate:
#  module: door_window
#  class: DoorWindow
#  windows:
#    - window: Front Window
#      sensor:
#        - sensor.front_window_right_state
#  doors:
#    - door: Front Door
#      sensor: sensor.front_door_state
#    - door: Back Door
#      sensor: sensor.back_door_state
